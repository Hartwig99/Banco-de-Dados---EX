10 – Escreva uma consulta que liste a o valor total vendido, além da participação de cada cidade
no total.
*/

SELECT		X.CIDADE,
			X.TOTAL_VENDA,
			(X.TOTAL_VENDA / SUM(X.TOTAL_VENDA) OVER())*100	AS PARTICIPACAO
FROM		(
				SELECT		CLI.CIDADE						AS CIDADE,
							SUM(MOV.QUANTIDADE * PRO.PRECO)	AS TOTAL_VENDA
				FROM		CLIENTE CLI
							INNER JOIN VENDA VDA 	 ON VDA.IDCLIENTE = CLI.IDCLIENTE
							INNER JOIN MOVIMENTO MOV ON CAST(SUBSTRING(MOV.IDORIGEM FROM 4) AS INTEGER) = VDA.IDVENDA
							INNER JOIN PRODUTO PRO	 ON PRO.IDPRODUTO = MOV.IDPRODUTO
				GROUP BY 	CLI.CIDADE
			) X
ORDER BY	X.CIDADE
